<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Upload</title>
    <style>
        #drop_zone {
            border: 2px dashed #ccc;
            border-radius: 5px;
            padding: 20px;
            text-align: center;
            margin: 20px auto;
            width: 50%;
            cursor: pointer;
        }

        #drop_zone.hover {
            border-color: #007bff;
        }

        #file_input {
            display: none;
        }

        .success_message {
            color: green;
            font-weight: bold;
            display: none;
        }
    </style>
</head>
<body>

<div id="drop_zone" ondragover="handleDragOver(event)" ondrop="handleFileSelect(event)" onclick="chooseFile()">
    <p>Drag and drop a file here, or click to select a file</p>
    <input type="file" id="file_input" onchange="handleFileSelect(event)">
</div>

<div id="success_message" class="success_message">
    File uploaded successfully!
</div>

<script>
    function handleFileSelect(evt) {
        evt.stopPropagation();
        evt.preventDefault();

        var files;
        if (evt.type === "drop") {
            files = evt.dataTransfer.files; // FileList object.
        } else {
            files = evt.target.files; // FileList object
        }

        // files is a FileList of File objects. List some properties.
        var output = [];
        for (var i = 0, f; f = files[i]; i++) {
            output.push('<li><strong>', escape(f.name), '</strong> (', f.type || 'n/a', ') - ',
                f.size, ' bytes, last modified: ',
                f.lastModifiedDate ? f.lastModifiedDate.toLocaleDateString() : 'n/a',
                '</li>');
        }
        document.getElementById('success_message').style.display = "block";
        document.getElementById('drop_zone').innerHTML = '<ul>' + output.join('') + '</ul>';
        
        // Sending file to server
        var formData = new FormData();
        formData.append("file", files[0]);
        
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "/user/upload/exl", true);
        xhr.onload = function () {
            if (xhr.status === 200) {
                console.log(xhr.responseText);
            } else {
                console.error(xhr.responseText);
            }
        };
        xhr.send(formData);
    }

    function handleDragOver(evt) {
        evt.stopPropagation();
        evt.preventDefault();
        evt.dataTransfer.dropEffect = 'copy'; // Explicitly show this is a copy.
        document.getElementById('drop_zone').classList.add('hover');
    }

    function chooseFile() {
        document.getElementById('file_input').click();
    }
</script>

</body>
</html>
